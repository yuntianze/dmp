## 背景需求

* 我希望用 **C++ 搭建一个最小可运行的 DMP-like 原型系统**，功能是实时风控 / 反欺诈，目标性能指标为 **P99 ≤ 50ms**。
* 我的目标是 **快速上手练手**，先做一个原型来验证可行性和性能，再逐步扩展。
* 我希望采用业界最佳实践原则，方案要 **实用、易落地**，同时给出清晰的架构与实现步骤。

## 约束与范围

1. 优先选择 **C/C++ 开源项目** 作为技术组件，尤其利用C17&C20的现代C++特性。
2. 原型阶段不考虑大规模分布式，只要求单机即可跑通，但要留出未来扩展 Kafka 流处理、CEP 等的接口。
3. 必须包含以下功能模块：

   * HTTP 接口接入
   * JSON 解析
   * 特征缓存（LRU + Redis 可选）
   * 规则引擎（表达式 / Rete）
   * 名单 / 模式匹配（正则批量匹配，可选）
   * 模型推理（ONNX Runtime）
   * 决策融合
   * 日志与指标监控
   * 热更新机制
   * 压测与基准测试方法
4. 输出文档时请按照**详细技术方案文档**的风格，包含以下章节：

   1. 目标与 SLO
   2. 组件清单（全 C++ 开源项目，按热路径顺序）
   3. 架构与线程模型（含数据流图描述）
   4. 数据契约（请求/响应格式）
   5. 规则与名单（ExprTk + Hyperscan）
   6. 特征工程与缓存设计（LRU + Redis）
   7. 模型推理（ONNX Runtime 配置与优化）
   8. 性能预算（各环节耗时表格，总体延迟估算）
   9. 热更新与版本化（规则/名单/模型）
   10. 观测与告警（Prometheus 指标 + spdlog 日志）
   11. 工程目录结构（CMake 项目结构）
   12. CMake 配置要点（编译优化、依赖）
   13. 基准与压测方法
   14. 安全与合规（脱敏、审计日志、兜底策略）
   15. 未来扩展点（Kafka、流处理、CEP、事件图）
5. 在描述时请给出 **组件选型理由**（为什么选 Drogon/simdjson/ExprTk/ONNX Runtime/Hyperscan 等，而不是其他框架）。
6. 最终的文档要像一个正式的技术设计方案，条理清晰，包含表格&图示和必要api和数据结构定义，并且对延迟控制给出定量分析。输出核心重点还是完整的技术设计方案，而无需输出代码实现。
